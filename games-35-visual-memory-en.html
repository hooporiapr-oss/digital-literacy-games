<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Visual Memory+ - Grades 3-5 | Akashic</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Georgia,serif;background:linear-gradient(135deg,#1e3a5f,#2d5a87);min-height:100vh;color:#fff;display:flex;flex-direction:column;align-items:center;padding:15px}
.header{text-align:center;margin-bottom:15px}
.title{font-size:1.8em;margin-bottom:5px}
.grade{background:rgba(255,255,255,0.2);padding:5px 15px;border-radius:20px;font-size:0.85em;display:inline-block}
.box{background:rgba(255,255,255,0.1);border:2px solid rgba(255,255,255,0.3);border-radius:16px;padding:20px;width:100%;max-width:380px}
.info{display:flex;justify-content:space-around;margin-bottom:15px;text-align:center}
.info-item b{display:block;font-size:1.5em;color:#ffd700}
.info-item span{font-size:0.75em;opacity:0.8}
.grid-container{background:rgba(0,0,0,0.2);border-radius:12px;padding:12px;margin-bottom:15px}
.grid{display:grid;gap:6px;max-width:300px;margin:0 auto}
.cell{aspect-ratio:1;background:rgba(255,255,255,0.15);border:3px solid rgba(255,255,255,0.3);border-radius:10px;cursor:pointer;transition:all 0.2s}
.cell.lit{background:linear-gradient(135deg,#ffd700,#ff8c00);border-color:#ffd700;box-shadow:0 0 20px rgba(255,215,0,0.6)}
.cell.correct{background:linear-gradient(135deg,#2ecc71,#27ae60);border-color:#2ecc71}
.cell.wrong{background:linear-gradient(135deg,#e74c3c,#c0392b);border-color:#e74c3c}
.cell:active{transform:scale(0.95)}
.status{text-align:center;font-size:1.1em;margin-bottom:15px;min-height:30px;color:#ffd700}
.lives{display:flex;justify-content:center;gap:8px;margin-bottom:15px;font-size:1.5em}
.life.lost{opacity:0.3}
.btn{width:100%;padding:15px;font-size:1.1em;font-weight:bold;border:none;border-radius:25px;cursor:pointer;margin-top:10px}
.btn-start{background:linear-gradient(135deg,#2ecc71,#27ae60);color:#fff}
.btn-again{background:linear-gradient(135deg,#ffd700,#ff8c00);color:#1e3a5f}
.btn:active{transform:scale(0.98)}
.result{text-align:center;padding:20px}
.result h2{color:#ffd700;font-size:1.5em;margin-bottom:10px}
.result .score{font-size:3em;color:#ffd700;font-weight:bold}
.result .label{opacity:0.8;margin-bottom:15px}
.stars{font-size:2em;margin:15px 0}
.hidden{display:none!important}
.home-link{position:absolute;top:15px;left:15px;color:#fff;text-decoration:none;font-size:0.9em;opacity:0.8}
.encouragement{background:rgba(255,215,0,0.2);padding:10px;border-radius:10px;text-align:center;margin-bottom:15px;font-size:0.95em}
.difficulty{display:flex;justify-content:center;gap:10px;margin-bottom:15px}
.diff-badge{padding:5px 12px;background:rgba(255,255,255,0.1);border:2px solid rgba(255,255,255,0.3);border-radius:15px;font-size:0.8em}
.diff-badge.active{background:rgba(255,215,0,0.3);border-color:#ffd700;color:#ffd700}
</style>
</head>
<body>
<a href="digital-literacy-homepage.html" class="home-link">‚Üê Back</a>

<div class="header">
<div class="title">üëÅÔ∏è Visual Memory+</div>
<div class="grade">üìö Grades 3-5 ‚Ä¢ Ages 8-11</div>
</div>

<div class="box">
<div id="startScreen">
<div class="encouragement">üß† Harder patterns with bigger grids! Can you keep up?</div>
<div class="info">
<div class="info-item"><b>3</b><span>Lives</span></div>
<div class="info-item"><b>4x4</b><span>Starting Grid</span></div>
<div class="info-item"><b>5x5</b><span>Max Grid</span></div>
</div>
<button class="btn btn-start" onclick="startGame()">‚ñ∂Ô∏è Play!</button>
</div>

<div id="gameScreen" class="hidden">
<div class="info">
<div class="info-item"><b id="levelNum">1</b><span>Level</span></div>
<div class="info-item"><b id="tilesNum">4</b><span>Tiles</span></div>
<div class="info-item"><b id="gridInfo">4x4</b><span>Grid</span></div>
</div>
<div class="lives" id="livesDisplay">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
<div class="status" id="status">Watch carefully!</div>
<div class="grid-container">
<div class="grid" id="grid"></div>
</div>
</div>

<div id="resultScreen" class="hidden">
<div class="result">
<h2 id="resultTitle">Great Job!</h2>
<div class="score" id="finalLevel">1</div>
<div class="label">Level Reached</div>
<div class="stars" id="stars">‚≠ê‚≠ê‚≠ê</div>
<button class="btn btn-again" onclick="startGame()">üîÑ Play Again!</button>
</div>
</div>
</div>

<script>
var level = 1;
var lives = 3;
var litTiles = [];
var selectedTiles = [];
var canSelect = false;
var gridSize = 4;
var tilesToShow = 4;

function $(id) { return document.getElementById(id); }

function show(id) {
    $('startScreen').classList.add('hidden');
    $('gameScreen').classList.add('hidden');
    $('resultScreen').classList.add('hidden');
    $(id).classList.remove('hidden');
}

function startGame() {
    level = 1;
    lives = 3;
    updateLives();
    show('gameScreen');
    buildLevel();
}

function getLevelParams(lvl) {
    // Grades 3-5: Start with 4x4, progress to 5x5
    // Level 1-3: 4x4 grid, 4-6 tiles
    // Level 4-6: 4x4 grid, 6-8 tiles
    // Level 7-9: 5x5 grid, 6-8 tiles
    // Level 10+: 5x5 grid, 8-10 tiles
    if (lvl <= 3) return { grid: 4, tiles: 3 + lvl };
    if (lvl <= 6) return { grid: 4, tiles: 5 + (lvl - 3) };
    if (lvl <= 9) return { grid: 5, tiles: 5 + (lvl - 6) };
    return { grid: 5, tiles: Math.min(12, 7 + (lvl - 9)) };
}

function buildLevel() {
    var params = getLevelParams(level);
    gridSize = params.grid;
    tilesToShow = params.tiles;
    
    $('levelNum').textContent = level;
    $('tilesNum').textContent = tilesToShow;
    $('gridInfo').textContent = gridSize + 'x' + gridSize;
    
    var grid = $('grid');
    grid.innerHTML = '';
    grid.style.gridTemplateColumns = 'repeat(' + gridSize + ', 1fr)';
    
    var total = gridSize * gridSize;
    for (var i = 0; i < total; i++) {
        var cell = document.createElement('div');
        cell.className = 'cell';
        cell.dataset.idx = i;
        cell.onclick = function() { selectCell(this); };
        grid.appendChild(cell);
    }
    
    // Pick random tiles
    litTiles = [];
    var available = [];
    for (var j = 0; j < total; j++) available.push(j);
    for (var k = 0; k < tilesToShow; k++) {
        var r = Math.floor(Math.random() * available.length);
        litTiles.push(available[r]);
        available.splice(r, 1);
    }
    
    selectedTiles = [];
    canSelect = false;
    showTiles();
}

function showTiles() {
    $('status').textContent = 'üëÄ Watch carefully!';
    var cells = $('grid').children;
    litTiles.forEach(function(idx) {
        cells[idx].classList.add('lit');
    });
    
    // Show time: 1 second base + 200ms per tile (faster than K-2)
    var showTime = 1000 + (tilesToShow * 200);
    setTimeout(hideTiles, showTime);
}

function hideTiles() {
    var cells = $('grid').children;
    litTiles.forEach(function(idx) {
        cells[idx].classList.remove('lit');
    });
    $('status').textContent = 'üëÜ Tap the squares!';
    canSelect = true;
}

function selectCell(cell) {
    if (!canSelect) return;
    var idx = parseInt(cell.dataset.idx);
    if (selectedTiles.indexOf(idx) !== -1) return;
    
    selectedTiles.push(idx);
    
    if (litTiles.indexOf(idx) !== -1) {
        cell.classList.add('correct');
        if (selectedTiles.length === litTiles.length) {
            canSelect = false;
            $('status').textContent = 'üéâ Excellent!';
            setTimeout(nextLevel, 1000);
        }
    } else {
        cell.classList.add('wrong');
        canSelect = false;
        lives--;
        updateLives();
        
        if (lives <= 0) {
            $('status').textContent = 'üò¢ Game Over!';
            setTimeout(showResult, 1500);
        } else {
            $('status').textContent = '‚ùå Oops! Watch again!';
            setTimeout(function() {
                showCorrectTiles();
                setTimeout(buildLevel, 1500);
            }, 500);
        }
    }
}

function showCorrectTiles() {
    var cells = $('grid').children;
    litTiles.forEach(function(idx) {
        cells[idx].classList.add('lit');
    });
}

function nextLevel() {
    level++;
    buildLevel();
}

function updateLives() {
    var html = '';
    for (var i = 0; i < 3; i++) {
        html += '<span class="life' + (i >= lives ? ' lost' : '') + '">‚ù§Ô∏è</span>';
    }
    $('livesDisplay').innerHTML = html;
}

function showResult() {
    show('resultScreen');
    $('finalLevel').textContent = level;
    
    var title, stars;
    if (level >= 10) { title = 'üèÜ Amazing!'; stars = '‚≠ê‚≠ê‚≠ê'; }
    else if (level >= 7) { title = 'üéâ Great Job!'; stars = '‚≠ê‚≠ê'; }
    else if (level >= 4) { title = 'üëç Good Try!'; stars = '‚≠ê'; }
    else { title = 'üí™ Keep Practicing!'; stars = ''; }
    
    $('resultTitle').textContent = title;
    $('stars').textContent = stars;
}
</script>
</body>
</html>
