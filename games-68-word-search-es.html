<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Sopa de Letras Avanzada - Grados 6-8 | Akashic</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Georgia,serif;background:linear-gradient(135deg,#1e3a5f,#2d5a87);min-height:100vh;color:#fff;display:flex;flex-direction:column;align-items:center;padding:10px}
.header{text-align:center;margin-bottom:8px}
.title{font-size:1.5em;margin-bottom:3px}
.grade{background:rgba(255,255,255,0.2);padding:4px 12px;border-radius:15px;font-size:0.8em;display:inline-block}
.box{background:rgba(255,255,255,0.1);border:2px solid rgba(255,255,255,0.3);border-radius:12px;padding:12px;width:100%;max-width:420px}
.info{display:flex;justify-content:space-around;margin-bottom:10px;text-align:center}
.info-item b{display:block;font-size:1.2em;color:#ffd700}
.info-item span{font-size:0.65em;opacity:0.8}
.grid-container{background:rgba(0,0,0,0.3);border-radius:10px;padding:8px;margin-bottom:10px;overflow-x:auto}
.grid{display:grid;gap:1px;width:fit-content;margin:0 auto;user-select:none}
.cell{width:26px;height:26px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);border-radius:3px;font-size:0.8em;font-weight:bold;cursor:pointer;transition:all 0.1s;text-transform:uppercase}
.cell:hover{background:rgba(255,255,255,0.2)}
.cell.selected{background:rgba(52,152,219,0.5);border-color:#3498db}
.cell.found{background:rgba(46,204,113,0.5);border-color:#2ecc71;color:#2ecc71}
.word-bank{margin-bottom:10px}
.word-bank-title{font-size:0.75em;color:#ffd700;margin-bottom:6px;text-align:center}
.word-list{display:flex;flex-wrap:wrap;gap:5px;justify-content:center}
.word-item{padding:3px 8px;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.3);border-radius:10px;font-size:0.7em;transition:all 0.2s}
.word-item.found{background:rgba(46,204,113,0.3);border-color:#2ecc71;text-decoration:line-through;opacity:0.6}
.status{text-align:center;font-size:0.9em;margin-bottom:8px;min-height:22px;color:#ffd700}
.timer-bar{width:100%;height:6px;background:rgba(255,255,255,0.2);border-radius:3px;margin-bottom:8px;overflow:hidden}
.timer-fill{height:100%;background:linear-gradient(90deg,#2ecc71,#27ae60);transition:width 1s linear}
.timer-fill.warning{background:linear-gradient(90deg,#f1c40f,#f39c12)}
.timer-fill.danger{background:linear-gradient(90deg,#e74c3c,#c0392b)}
.btn{width:100%;padding:12px;font-size:1em;font-weight:bold;border:none;border-radius:20px;cursor:pointer;margin-top:8px}
.btn-start{background:linear-gradient(135deg,#2ecc71,#27ae60);color:#fff}
.btn-again{background:linear-gradient(135deg,#ffd700,#ff8c00);color:#1e3a5f}
.btn:active{transform:scale(0.98)}
.result{text-align:center;padding:15px}
.result h2{color:#ffd700;font-size:1.3em;margin-bottom:8px}
.result .score{font-size:2.5em;color:#ffd700;font-weight:bold}
.result .label{opacity:0.8;margin-bottom:10px;font-size:0.9em}
.result-stats{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin:12px 0}
.result-stat{background:rgba(0,0,0,0.2);padding:8px;border-radius:6px;text-align:center}
.result-stat b{display:block;color:#ffd700;font-size:1.1em}
.result-stat span{font-size:0.7em;opacity:0.8}
.hidden{display:none!important}
.home-link{position:absolute;top:10px;left:10px;color:#fff;text-decoration:none;font-size:0.85em;opacity:0.8}
.encouragement{background:rgba(255,215,0,0.2);padding:8px;border-radius:8px;text-align:center;margin-bottom:10px;font-size:0.8em;line-height:1.4}
.definition{background:rgba(52,152,219,0.2);padding:6px;border-radius:6px;text-align:center;font-size:0.75em;min-height:35px}
</style>
</head>
<body>
<a href="digital-literacy-homepage.html" class="home-link">‚Üê Volver</a>

<div class="header">
<div class="title">üîç Sopa de Letras Avanzada</div>
<div class="grade">üöÄ Grados 6-8 ‚Ä¢ Edades 11-14</div>
</div>

<div class="box">
<div id="startScreen">
<div class="encouragement">üß† ¬°Encuentra t√©rminos de ciberseguridad! Palabras m√°s dif√≠ciles, cuadr√≠cula m√°s grande.</div>
<div class="info">
<div class="info-item"><b>15</b><span>Palabras</span></div>
<div class="info-item"><b>12x12</b><span>Cuadr√≠cula</span></div>
<div class="info-item"><b>4:00</b><span>L√≠mite</span></div>
</div>
<button class="btn btn-start" onclick="startGame()">‚ñ∂Ô∏è ¬°Comenzar Desaf√≠o!</button>
</div>

<div id="gameScreen" class="hidden">
<div class="info">
<div class="info-item"><b id="foundCount">0</b><span>Encontradas</span></div>
<div class="info-item"><b id="timerDisplay">4:00</b><span>Tiempo</span></div>
<div class="info-item"><b id="totalWords">15</b><span>Total</span></div>
</div>
<div class="timer-bar"><div class="timer-fill" id="timerBar"></div></div>
<div class="word-bank">
<div class="word-bank-title">üîê T√âRMINOS DE CIBERSEGURIDAD</div>
<div class="word-list" id="wordList"></div>
</div>
<div class="grid-container">
<div class="grid" id="grid"></div>
</div>
<div class="status" id="status">¬°Arrastra para seleccionar!</div>
<div class="definition" id="definition">¬°Encuentra una palabra para ver su significado!</div>
</div>

<div id="resultScreen" class="hidden">
<div class="result">
<h2 id="resultTitle">¬°Desaf√≠o Completado!</h2>
<div class="score" id="finalScore">0/15</div>
<div class="label">Palabras Encontradas</div>
<div class="result-stats">
<div class="result-stat"><b id="finalTime">0:00</b><span>Tiempo Usado</span></div>
<div class="result-stat"><b id="finalAccuracy">0%</b><span>Completado</span></div>
</div>
<button class="btn btn-again" onclick="startGame()">üîÑ ¬°Intentar de Nuevo!</button>
</div>
</div>
</div>

<script>
var words = [
    {word: 'PHISHING', def: 'Correos/sitios falsos que enga√±an para obtener info'},
    {word: 'MALWARE', def: 'Software malicioso dise√±ado para da√±ar computadoras'},
    {word: 'FIREWALL', def: 'Sistema de seguridad que monitorea el tr√°fico de red'},
    {word: 'CIFRADO', def: 'Convertir datos en un c√≥digo secreto'},
    {word: 'HACKER', def: 'Persona que entra a sistemas sin permiso'},
    {word: 'RANSOMWARE', def: 'Malware que bloquea archivos hasta que pagues'},
    {word: 'SPYWARE', def: 'Software que recolecta tus datos en secreto'},
    {word: 'ANTIVIRUS', def: 'Programa que protege contra malware'},
    {word: 'RESPALDO', def: 'Copia de datos guardada por seguridad'},
    {word: 'TROYANO', def: 'Malware disfrazado de software leg√≠timo'},
    {word: 'BOTNET', def: 'Red de computadoras infectadas controladas remotamente'},
    {word: 'COOKIES', def: 'Peque√±os archivos que los sitios guardan en tu PC'},
    {word: 'HTTPS', def: 'Versi√≥n segura del protocolo web'},
    {word: 'VPN', def: 'Red Privada Virtual para navegaci√≥n segura'},
    {word: 'SPAM', def: 'Mensajes masivos no deseados'},
    {word: 'ESTAFA', def: 'Esquema fraudulento para robar dinero/info'},
    {word: 'PARCHE', def: 'Actualizaci√≥n que arregla problemas de seguridad'},
    {word: 'BRECHA', def: 'Acceso no autorizado a datos protegidos'}
];

var gridSize = 12;
var grid = [];
var selectedCells = [];
var isSelecting = false;
var gameWords = [];
var foundWords = [];
var timer = null;
var timeLeft = 240;
var totalTime = 240;
var definitions = {};

function $(id) { return document.getElementById(id); }

function show(id) {
    $('startScreen').classList.add('hidden');
    $('gameScreen').classList.add('hidden');
    $('resultScreen').classList.add('hidden');
    $(id).classList.remove('hidden');
}

function shuffle(arr) {
    for (var i = arr.length - 1; i > 0; i--) {
        var j = Math.floor(Math.random() * (i + 1));
        var t = arr[i]; arr[i] = arr[j]; arr[j] = t;
    }
    return arr;
}

function startGame() {
    gameWords = shuffle(words.slice()).slice(0, 15).map(function(w) { return w.word; });
    foundWords = [];
    timeLeft = totalTime;
    
    definitions = {};
    words.forEach(function(w) { definitions[w.word] = w.def; });
    
    grid = [];
    for (var i = 0; i < gridSize; i++) {
        grid[i] = [];
        for (var j = 0; j < gridSize; j++) {
            grid[i][j] = {letter: '', wordPart: false};
        }
    }
    
    gameWords.forEach(function(word) { placeWord(word); });
    
    var letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    for (var i = 0; i < gridSize; i++) {
        for (var j = 0; j < gridSize; j++) {
            if (!grid[i][j].letter) {
                grid[i][j].letter = letters[Math.floor(Math.random() * letters.length)];
            }
        }
    }
    
    renderGrid();
    renderWordList();
    $('foundCount').textContent = '0';
    $('totalWords').textContent = gameWords.length;
    $('status').textContent = '¬°Arrastra para seleccionar!';
    $('definition').textContent = '¬°Encuentra una palabra para ver su significado!';
    $('timerBar').style.width = '100%';
    $('timerBar').className = 'timer-fill';
    
    show('gameScreen');
    startTimer();
}

function placeWord(word) {
    var directions = [
        {dr: 0, dc: 1}, {dr: 1, dc: 0}, {dr: 1, dc: 1}, {dr: 1, dc: -1},
        {dr: 0, dc: -1}, {dr: -1, dc: 0}, {dr: -1, dc: -1}, {dr: -1, dc: 1}
    ];
    
    var placed = false;
    var attempts = 0;
    
    while (!placed && attempts < 200) {
        var dir = directions[Math.floor(Math.random() * directions.length)];
        var row = Math.floor(Math.random() * gridSize);
        var col = Math.floor(Math.random() * gridSize);
        
        if (canPlace(word, row, col, dir.dr, dir.dc)) {
            for (var i = 0; i < word.length; i++) {
                grid[row + i * dir.dr][col + i * dir.dc] = {
                    letter: word[i],
                    wordPart: true
                };
            }
            placed = true;
        }
        attempts++;
    }
}

function canPlace(word, row, col, dr, dc) {
    for (var i = 0; i < word.length; i++) {
        var r = row + i * dr;
        var c = col + i * dc;
        if (r < 0 || r >= gridSize || c < 0 || c >= gridSize) return false;
        if (grid[r][c].letter && grid[r][c].letter !== word[i]) return false;
    }
    return true;
}

function renderGrid() {
    var container = $('grid');
    container.innerHTML = '';
    container.style.gridTemplateColumns = 'repeat(' + gridSize + ', 26px)';
    
    for (var i = 0; i < gridSize; i++) {
        for (var j = 0; j < gridSize; j++) {
            var cell = document.createElement('div');
            cell.className = 'cell';
            cell.textContent = grid[i][j].letter;
            cell.dataset.row = i;
            cell.dataset.col = j;
            
            cell.addEventListener('mousedown', startSelect);
            cell.addEventListener('mouseover', continueSelect);
            cell.addEventListener('touchstart', handleTouch);
            cell.addEventListener('touchmove', handleTouchMove);
            
            container.appendChild(cell);
        }
    }
    
    document.addEventListener('mouseup', endSelect);
    document.addEventListener('touchend', endSelect);
}

function renderWordList() {
    var list = $('wordList');
    list.innerHTML = '';
    gameWords.forEach(function(word) {
        var item = document.createElement('span');
        item.className = 'word-item';
        item.textContent = word;
        item.id = 'word-' + word;
        list.appendChild(item);
    });
}

function startSelect(e) {
    e.preventDefault();
    isSelecting = true;
    selectedCells = [{row: parseInt(e.target.dataset.row), col: parseInt(e.target.dataset.col)}];
    updateSelection();
}

function continueSelect(e) {
    if (!isSelecting) return;
    var row = parseInt(e.target.dataset.row);
    var col = parseInt(e.target.dataset.col);
    if (isNaN(row) || isNaN(col)) return;
    
    if (selectedCells.length === 1 || isValidLine(row, col)) {
        var exists = selectedCells.some(function(c) { return c.row === row && c.col === col; });
        if (!exists) {
            selectedCells.push({row: row, col: col});
            updateSelection();
        }
    }
}

function handleTouch(e) {
    e.preventDefault();
    var touch = e.touches[0];
    var cell = document.elementFromPoint(touch.clientX, touch.clientY);
    if (cell && cell.classList.contains('cell')) {
        isSelecting = true;
        selectedCells = [{row: parseInt(cell.dataset.row), col: parseInt(cell.dataset.col)}];
        updateSelection();
    }
}

function handleTouchMove(e) {
    e.preventDefault();
    var touch = e.touches[0];
    var cell = document.elementFromPoint(touch.clientX, touch.clientY);
    if (cell && cell.classList.contains('cell')) {
        var row = parseInt(cell.dataset.row);
        var col = parseInt(cell.dataset.col);
        if (!isNaN(row) && !isNaN(col)) {
            if (selectedCells.length === 1 || isValidLine(row, col)) {
                var exists = selectedCells.some(function(c) { return c.row === row && c.col === col; });
                if (!exists) {
                    selectedCells.push({row: row, col: col});
                    updateSelection();
                }
            }
        }
    }
}

function isValidLine(row, col) {
    if (selectedCells.length < 1) return true;
    var first = selectedCells[0];
    var dr = row - first.row;
    var dc = col - first.col;
    var len = Math.max(Math.abs(dr), Math.abs(dc));
    if (len === 0) return false;
    dr = dr / len; dc = dc / len;
    if (Math.abs(dr) > 1 || Math.abs(dc) > 1) return false;
    if (dr !== 0 && dc !== 0 && Math.abs(dr) !== Math.abs(dc)) return false;
    return true;
}

function updateSelection() {
    var cells = document.querySelectorAll('.cell');
    cells.forEach(function(c) { c.classList.remove('selected'); });
    selectedCells.forEach(function(pos) {
        var idx = pos.row * gridSize + pos.col;
        cells[idx].classList.add('selected');
    });
}

function endSelect() {
    if (!isSelecting) return;
    isSelecting = false;
    
    var selected = selectedCells.map(function(c) { return grid[c.row][c.col].letter; }).join('');
    var reversed = selected.split('').reverse().join('');
    
    var matchedWord = null;
    gameWords.forEach(function(word) {
        if ((selected === word || reversed === word) && foundWords.indexOf(word) === -1) {
            matchedWord = word;
        }
    });
    
    if (matchedWord) {
        foundWords.push(matchedWord);
        $('foundCount').textContent = foundWords.length;
        $('word-' + matchedWord).classList.add('found');
        $('status').textContent = '‚úì ¬°' + matchedWord + '!';
        $('definition').textContent = 'üí° ' + definitions[matchedWord];
        
        var cells = document.querySelectorAll('.cell');
        selectedCells.forEach(function(pos) {
            cells[pos.row * gridSize + pos.col].classList.add('found');
        });
        
        if (foundWords.length === gameWords.length) {
            clearInterval(timer);
            setTimeout(showResult, 800);
        }
    }
    
    document.querySelectorAll('.cell').forEach(function(c) { c.classList.remove('selected'); });
    selectedCells = [];
}

function startTimer() {
    if (timer) clearInterval(timer);
    timer = setInterval(function() {
        timeLeft--;
        var min = Math.floor(timeLeft / 60);
        var sec = timeLeft % 60;
        $('timerDisplay').textContent = min + ':' + (sec < 10 ? '0' : '') + sec;
        
        var pct = (timeLeft / totalTime) * 100;
        $('timerBar').style.width = pct + '%';
        if (pct < 25) $('timerBar').className = 'timer-fill danger';
        else if (pct < 50) $('timerBar').className = 'timer-fill warning';
        
        if (timeLeft <= 0) {
            clearInterval(timer);
            showResult();
        }
    }, 1000);
}

function showResult() {
    show('resultScreen');
    $('finalScore').textContent = foundWords.length + '/' + gameWords.length;
    
    var timeUsed = totalTime - timeLeft;
    var min = Math.floor(timeUsed / 60);
    var sec = timeUsed % 60;
    $('finalTime').textContent = min + ':' + (sec < 10 ? '0' : '') + sec;
    
    var pct = Math.round((foundWords.length / gameWords.length) * 100);
    $('finalAccuracy').textContent = pct + '%';
    
    var title;
    if (pct === 100) title = 'üèÜ ¬°Perfecto!';
    else if (pct >= 80) title = '‚≠ê ¬°Excelente!';
    else if (pct >= 60) title = 'üëç ¬°Buen Trabajo!';
    else title = 'üí™ ¬°Sigue Practicando!';
    
    $('resultTitle').textContent = title;
}
</script>
</body>
</html>
